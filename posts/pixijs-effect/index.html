<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/home/styles.9f0a6db226650febf4c6.css">@import url(https://fonts.googleapis.com/css?family=Nunito+Sans:400,600,700,800);@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css);.navbar{background-color:#fbfbfb!important}#banner{height:60vh;background-color:#fff;color:#173950;mask:url(/home/static/hero-mask-02df0a2bd19a714ee2bf5c468e1646b7.png) top left round;-webkit-mask:url(/home/static/hero-mask-02df0a2bd19a714ee2bf5c468e1646b7.png) top left round}@media only screen and (max-width:600px){#banner{mask:url(/home/static/hero-mask-mobile-fd598a9789eb8a34cb6eb8600d3a0da4.png) top left round;-webkit-mask:url(/home/static/hero-mask-mobile-fd598a9789eb8a34cb6eb8600d3a0da4.png) top left round}}#banner_title{background-color:#fff}#banner_title,.container{position:relative}#banner_canvas{width:100vw;height:100vh;background-color:#fff;position:fixed}.inner_container{background-color:#fff;position:relative;overflow:auto}#banner_canvas_container{position:absolute}body{font-family:Nunito Sans,sans-serif!important;color:#173950!important}#hello{color:#f36}#back_to_main{color:#173950!important}.content_container{background-color:#fff;position:relative;overflow:hidden}.jumbotron{background-color:#fff!important}footer{background-color:#fff;position:relative;font-size:12px}a{color:#2ec4b6!important}svg{fill:#20a4f3!important}svg:hover{fill:#11679a!important}.card{border-width:0!important}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><meta name="generator" content="Gatsby 2.1.11"/><title data-react-helmet="true">Home | Matias Heikkilä&#x27;s homepage</title><link data-react-helmet="true" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous"/><meta data-react-helmet="true" name="description" content="I&#x27;m doing a PhD in statistics and I write code sometimes."/><meta data-react-helmet="true" property="og:title" content="Home"/><meta data-react-helmet="true" property="og:description" content="I&#x27;m doing a PhD in statistics and I write code sometimes."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Matias Heikkilä"/><meta data-react-helmet="true" name="twitter:title" content="Home"/><meta data-react-helmet="true" name="twitter:description" content="I&#x27;m doing a PhD in statistics and I write code sometimes."/><meta data-react-helmet="true" name="keywords" content="gatsby, application, react"/><link rel="manifest" href="/home/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/home/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/home/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/home/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/home/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/home/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/home/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/home/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/home/icons/icon-512x512.png"/><link as="script" rel="preload" href="/home/webpack-runtime-eee017a89d85ed690d78.js"/><link as="script" rel="preload" href="/home/app-07d2b8436a939d6297eb.js"/><link as="script" rel="preload" href="/home/styles-472800638612e54f4a1e.js"/><link as="script" rel="preload" href="/home/1-e24ffb3a17e01c437e08.js"/><link as="script" rel="preload" href="/home/2-21bfe4eb631e7c801622.js"/><link as="script" rel="preload" href="/home/11-e039b23e024fb713bfa2.js"/><link as="script" rel="preload" href="/home/component---src-pages-posts-pixijs-effect-jsx-56d2b5543f2e7a3e0706.js"/><link as="fetch" rel="preload" href="/home/static/d/798/path---posts-pixijs-effect-352-472-NZuapzHg3X9TaN1iIixfv1W23E.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div><div><nav class="navbar navbar-light"><a id="back_to_main" href="/home/"><span id="hello">Hello</span>,<br/>I&#x27;m Matias</a></nav></div><main><div class="content_container"><div class="inner_container container p-5"><div id="post_container" class="row"><div class="col-md-2"></div><div class="col-md-8"><a href="https://github.com/mahepe/pixijs-effect"><svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a><h2>Creating a particle effect using PIXI.js</h2><p><a href="http://www.pixijs.com/">PixiJS</a> is a famous WebGL-wrapper, or in other words, a
thing that gives you easy access to high graphics performance on a HTML canvas.
I have seen a lot of beautiful hero canvases and thought something like that
could work for my personal website too. I modified
<a href="https://codepen.io/jh3y/pen/VdMBaR?page=6">a pretty well-written codepen</a> to
produce <a href="https://mahepe.github.io/pixijs-effect/">this</a> effect I&#x27;m quite happy
with. I&#x27;ll just go ahead and briefly describe how it works.</p><h3>Initialization</h3><p>I wanted to use an existing canvas for my PIXI app, which can be achieved as
follows.</p><pre><code class="language-javascript">const canvas = document.getElementById(&quot;banner_canvas&quot;);
var app = new PIXI.Application(window.innerWidth,
                               window.innerHeight,
                               {view: canvas,
                                antialias: true,
                                transparent: true});</code></pre><p>For performance and improved control over the particles, they are put into a
container.</p><pre><code class="language-javascript">const drops = new PIXI.Container();
app.stage.addChild(drops)</code></pre><p>We want to draw circles. It&#x27;s possible to use <code>PIXI.Graphics</code> for drawing shapes
such as circles. However, it&#x27;s very inefficient to execute a new graphics fill
on each draw call. A much better approach is to proceed as follows:</p><ol><li>Draw a circle using <code>PIXI.Graphics</code>.</li><li>Save the circle in a texture.</li><li>Use the texture to create a sprite for each particle.</li></ol><pre><code class="language-javascript">// Create a base graphic for our sprites
const p = new PIXI.Graphics()
p.beginFill(COLOR)
p.drawCircle(0, 0, 100)
p.endFill()

// Generate a base texture from the base graphic
const baseTexture = app.renderer.generateTexture(p)
let particles = genParticles(baseTexture)</code></pre><h3>The particle generator and the updater</h3><p>The particle generator works like this (paraphrased), nothing that interesting
going on there.</p><pre><code class="language-javascript">const genParticles = (texture) =&gt;
      new Array(AMOUNT).fill().map(p =&gt; {
          var p = new PIXI.Sprite(texture);

          // Spawn a particle at a random position
          p.x = Math.random()*window.innerWidth;
          p.y = Math.random()*window.innerHeight;

          // Set an initial velocity.
          p.vx = 1;

          drops.addChild(p);
          return p;
      });</code></pre><p>The updater has some nice tricks.</p><pre><code class="language-javascript">app.ticker.add(function(delta) {
    if (
        app.renderer.height !== innerHeight ||
            app.renderer.width !== innerWidth
    ) {
        app.renderer.resize(innerWidth, innerHeight)
        drops.removeChildren()
        particles = genParticles(baseTexture)
    }

    for(let p of particles){
        p.x += delta*p.vx;
        p.y += delta*p.vy;
        if(p.x &gt;= window.innerWidth + 20){
            p.x = -20;
        }
    }
    app.renderer.render(drops);
});</code></pre><p>This will reset the animation and regenerate everything in case the window is
resized so that the animation will not appear distorted.</p><pre><code class="language-javascript">if (
    app.renderer.height !== innerHeight ||
        app.renderer.width !== innerWidth
) {
    app.renderer.resize(innerWidth, innerHeight)
    drops.removeChildren()
    particles = genParticles(baseTexture)
}</code></pre><p>This will put a particle that leaves the screen from the right slightly outside
the left side of the screen. This will give an impression of an infinite amount
of particles.</p><pre><code class="language-javascript">if(p.x &gt;= window.innerWidth + 20){
    p.x = -20;
}</code></pre><h3>Conclusion</h3><p>Since the resulting animation is pretty intense for a hero element,
I combined it with some CSS masking to keep things under control. WebGL is
really powerful since I didn&#x27;t observe any lag with <code>AMOUNT=2000</code>. All in all,
I had a lot of fun making this, and I strongly recommend trying PIXI.js if you
haven&#x27;t already.</p></div><div class="col-md-2"></div></div></div></div></main><footer><div class="container text-center">© <!-- -->2019<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a>.<a href="/home/privacy"> Privacy policy</a></div></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-pages-posts-pixijs-effect-jsx","jsonName":"posts-pixijs-effect-352","path":"/posts/pixijs-effect/"};window.dataPath="798/path---posts-pixijs-effect-352-472-NZuapzHg3X9TaN1iIixfv1W23E";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-07d2b8436a939d6297eb.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-b54948a13bb1d7397a41.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-599b07c1d85c638390d7.js"],"component---src-pages-posts-pixijs-effect-jsx":["/component---src-pages-posts-pixijs-effect-jsx-56d2b5543f2e7a3e0706.js"],"component---src-pages-privacy-jsx":["/component---src-pages-privacy-jsx-7a2e7d28cdf28dbc9e30.js"],"component---src-pages-publications-jsx":["/component---src-pages-publications-jsx-7363f313564eabf1d685.js"],"pages-manifest":["/pages-manifest-a78aa212f8e3ef14a6f5.js"]};/*]]>*/</script><script src="/home/component---src-pages-posts-pixijs-effect-jsx-56d2b5543f2e7a3e0706.js" async=""></script><script src="/home/11-e039b23e024fb713bfa2.js" async=""></script><script src="/home/2-21bfe4eb631e7c801622.js" async=""></script><script src="/home/1-e24ffb3a17e01c437e08.js" async=""></script><script src="/home/styles-472800638612e54f4a1e.js" async=""></script><script src="/home/app-07d2b8436a939d6297eb.js" async=""></script><script src="/home/webpack-runtime-eee017a89d85ed690d78.js" async=""></script></body></html>